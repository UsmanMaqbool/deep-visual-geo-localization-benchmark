/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
2023-10-29 19:22:24   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=0.0001, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder=None, pca_dim=None, pretrain='offtheshelf', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume=None, saturation=0, save_dir='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct', seed=43, test_method='hard_resize', train_batch_size=1, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-29 19:22:24   The outputs are being saved in /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct
2023-10-29 19:22:24   Using 1 GPUs and 32 CPUs
2023-10-29 19:22:24   Loading dataset pitts30k from folder datasets_vg/datasets
2023-10-29 19:22:24   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order)
2023-10-29 19:22:24   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2023-10-29 19:22:24   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2023-10-29 19:22:24   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-29 19:22:25   Train last layers of the vgg16, freeze the previous ones
Matconvnet Loaded
2023-10-29 19:22:26   Output dimension of the model is 32768, with 188.09 GFLOPs
2023-10-29 19:22:26   Start training epoch: 00
2023-10-29 19:22:26   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:33<00:00,  3.69it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:10<00:00, 14.15it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:06<00:00,  7.91it/s]
2023-10-29 19:27:16   Epoch[00](0/5): current batch triplet loss = 0.0795, average epoch triplet loss = 0.0683
2023-10-29 19:27:16   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:12<00:00, 13.79it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 19:32:03   Epoch[00](1/5): current batch triplet loss = 0.0939, average epoch triplet loss = 0.0631
2023-10-29 19:32:03   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.55it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 19:36:49   Epoch[00](2/5): current batch triplet loss = 0.1108, average epoch triplet loss = 0.0582
2023-10-29 19:36:49   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:15<00:00, 13.24it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 19:41:38   Epoch[00](3/5): current batch triplet loss = 0.0830, average epoch triplet loss = 0.0547
2023-10-29 19:41:38   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.42it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 19:46:25   Epoch[00](4/5): current batch triplet loss = 0.0016, average epoch triplet loss = 0.0530
2023-10-29 19:46:25   Finished epoch 00 in 0:23:58, average epoch triplet loss = 0.0530
2023-10-29 19:46:25   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:25<00:00,  3.67it/s]
2023-10-29 19:47:50   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:05<00:00,  3.63it/s]
2023-10-29 19:48:56   Calculating recalls
2023-10-29 19:49:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 71.5, R@5: 86.8, R@10: 91.0, R@20: 94.3
2023-10-29 19:49:09   Improved: previous best R@5 = 0.0, current R@5 = 86.8
2023-10-29 19:49:09   Start training epoch: 01
2023-10-29 19:49:09   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:12<00:00, 13.80it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.26it/s]
2023-10-29 19:53:53   Epoch[01](0/5): current batch triplet loss = 0.0047, average epoch triplet loss = 0.0427
2023-10-29 19:53:53   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.65it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 19:58:39   Epoch[01](1/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0422
2023-10-29 19:58:39   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.62it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.19it/s]
2023-10-29 20:03:26   Epoch[01](2/5): current batch triplet loss = 0.0478, average epoch triplet loss = 0.0408
2023-10-29 20:03:26   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.55it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-29 20:08:15   Epoch[01](3/5): current batch triplet loss = 0.0492, average epoch triplet loss = 0.0403
2023-10-29 20:08:15   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.55it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-29 20:13:03   Epoch[01](4/5): current batch triplet loss = 0.0552, average epoch triplet loss = 0.0396
2023-10-29 20:13:03   Finished epoch 01 in 0:23:54, average epoch triplet loss = 0.0396
2023-10-29 20:13:03   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:27<00:00,  3.59it/s]
2023-10-29 20:14:31   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.51it/s]
2023-10-29 20:15:39   Calculating recalls
2023-10-29 20:15:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.5, R@5: 89.2, R@10: 92.9, R@20: 95.2
2023-10-29 20:15:54   Improved: previous best R@5 = 86.8, current R@5 = 89.2
2023-10-29 20:15:54   Start training epoch: 02
2023-10-29 20:15:54   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.67it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 20:20:40   Epoch[02](0/5): current batch triplet loss = 0.0069, average epoch triplet loss = 0.0370
2023-10-29 20:20:40   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.55it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:03<00:00,  8.10it/s]
2023-10-29 20:25:29   Epoch[02](1/5): current batch triplet loss = 0.0267, average epoch triplet loss = 0.0357
2023-10-29 20:25:29   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.70it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.54it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:04<00:00,  8.03it/s]
2023-10-29 20:30:20   Epoch[02](2/5): current batch triplet loss = 0.0496, average epoch triplet loss = 0.0356
2023-10-29 20:30:20   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.62it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 20:35:06   Epoch[02](3/5): current batch triplet loss = 0.0098, average epoch triplet loss = 0.0352
2023-10-29 20:35:06   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.67it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 20:39:52   Epoch[02](4/5): current batch triplet loss = 0.0824, average epoch triplet loss = 0.0347
2023-10-29 20:39:52   Finished epoch 02 in 0:23:57, average epoch triplet loss = 0.0347
2023-10-29 20:39:52   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.64it/s]
2023-10-29 20:41:18   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:08<00:00,  3.48it/s]
2023-10-29 20:42:27   Calculating recalls
2023-10-29 20:42:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.9, R@5: 90.7, R@10: 93.9, R@20: 95.7
2023-10-29 20:42:40   Improved: previous best R@5 = 89.2, current R@5 = 90.7
2023-10-29 20:42:40   Start training epoch: 03
2023-10-29 20:42:40   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.66it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 20:47:26   Epoch[03](0/5): current batch triplet loss = 0.0033, average epoch triplet loss = 0.0323
2023-10-29 20:47:26   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.65it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 20:52:12   Epoch[03](1/5): current batch triplet loss = 0.0034, average epoch triplet loss = 0.0325
2023-10-29 20:52:12   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.61it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 20:56:58   Epoch[03](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0320
2023-10-29 20:56:58   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.64it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:01:44   Epoch[03](3/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0314
2023-10-29 21:01:44   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:06:30   Epoch[03](4/5): current batch triplet loss = 0.0260, average epoch triplet loss = 0.0315
2023-10-29 21:06:30   Finished epoch 03 in 0:23:50, average epoch triplet loss = 0.0315
2023-10-29 21:06:30   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.61it/s]
2023-10-29 21:07:57   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:08<00:00,  3.47it/s]
2023-10-29 21:09:06   Calculating recalls
2023-10-29 21:09:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.7, R@5: 91.3, R@10: 94.1, R@20: 96.0
2023-10-29 21:09:19   Improved: previous best R@5 = 90.7, current R@5 = 91.3
2023-10-29 21:09:19   Start training epoch: 04
2023-10-29 21:09:19   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.64it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:14:05   Epoch[04](0/5): current batch triplet loss = 0.0240, average epoch triplet loss = 0.0303
2023-10-29 21:14:05   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.68it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:18:50   Epoch[04](1/5): current batch triplet loss = 0.1091, average epoch triplet loss = 0.0298
2023-10-29 21:18:50   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.62it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:23:36   Epoch[04](2/5): current batch triplet loss = 0.0123, average epoch triplet loss = 0.0295
2023-10-29 21:23:36   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.63it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.26it/s]
2023-10-29 21:28:22   Epoch[04](3/5): current batch triplet loss = 0.0024, average epoch triplet loss = 0.0291
2023-10-29 21:28:22   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.57it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 21:33:09   Epoch[04](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0288
2023-10-29 21:33:09   Finished epoch 04 in 0:23:50, average epoch triplet loss = 0.0288
2023-10-29 21:33:09   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.63it/s]
2023-10-29 21:34:35   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.52it/s]
2023-10-29 21:35:43   Calculating recalls
2023-10-29 21:35:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.1, R@5: 91.5, R@10: 94.3, R@20: 96.2
2023-10-29 21:35:55   Improved: previous best R@5 = 91.3, current R@5 = 91.5
2023-10-29 21:35:55   Start training epoch: 05
2023-10-29 21:35:55   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:40:42   Epoch[05](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0283
2023-10-29 21:40:42   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.61it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 21:45:28   Epoch[05](1/5): current batch triplet loss = 0.0221, average epoch triplet loss = 0.0284
2023-10-29 21:45:28   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.64it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.22it/s]
2023-10-29 21:50:15   Epoch[05](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0274
2023-10-29 21:50:15   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.56it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 21:55:02   Epoch[05](3/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0274
2023-10-29 21:55:02   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.41it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 21:59:49   Epoch[05](4/5): current batch triplet loss = 0.0292, average epoch triplet loss = 0.0273
2023-10-29 21:59:49   Finished epoch 05 in 0:23:53, average epoch triplet loss = 0.0273
2023-10-29 21:59:49   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:27<00:00,  3.57it/s]
2023-10-29 22:01:17   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.54it/s]
2023-10-29 22:02:25   Calculating recalls
2023-10-29 22:02:38   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.7, R@5: 91.7, R@10: 94.6, R@20: 96.4
2023-10-29 22:02:38   Improved: previous best R@5 = 91.5, current R@5 = 91.7
2023-10-29 22:02:38   Start training epoch: 06
2023-10-29 22:02:38   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.63it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.21it/s]
2023-10-29 22:07:25   Epoch[06](0/5): current batch triplet loss = 0.0444, average epoch triplet loss = 0.0266
2023-10-29 22:07:25   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.64it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.22it/s]
2023-10-29 22:12:11   Epoch[06](1/5): current batch triplet loss = 0.0126, average epoch triplet loss = 0.0268
2023-10-29 22:12:11   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-29 22:16:58   Epoch[06](2/5): current batch triplet loss = 0.0159, average epoch triplet loss = 0.0262
2023-10-29 22:16:58   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.63it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 22:21:44   Epoch[06](3/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0260
2023-10-29 22:21:44   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:11<00:00, 13.98it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 22:26:28   Epoch[06](4/5): current batch triplet loss = 0.0094, average epoch triplet loss = 0.0256
2023-10-29 22:26:28   Finished epoch 06 in 0:23:50, average epoch triplet loss = 0.0256
2023-10-29 22:26:28   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:27<00:00,  3.58it/s]
2023-10-29 22:27:56   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:09<00:00,  3.43it/s]
2023-10-29 22:29:06   Calculating recalls
2023-10-29 22:29:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.3, R@5: 92.0, R@10: 94.8, R@20: 96.4
2023-10-29 22:29:19   Improved: previous best R@5 = 91.7, current R@5 = 92.0
2023-10-29 22:29:19   Start training epoch: 07
2023-10-29 22:29:19   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.78it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:12<00:00, 13.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 22:34:05   Epoch[07](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0238
2023-10-29 22:34:05   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.65it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 22:38:51   Epoch[07](1/5): current batch triplet loss = 0.0006, average epoch triplet loss = 0.0242
2023-10-29 22:38:51   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.61it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 22:43:37   Epoch[07](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0240
2023-10-29 22:43:37   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:12<00:00, 13.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 22:48:22   Epoch[07](3/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0238
2023-10-29 22:48:22   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.66it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 22:53:08   Epoch[07](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0235
2023-10-29 22:53:08   Finished epoch 07 in 0:23:48, average epoch triplet loss = 0.0235
2023-10-29 22:53:08   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.61it/s]
2023-10-29 22:54:35   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.51it/s]
2023-10-29 22:55:43   Calculating recalls
2023-10-29 22:55:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.1, R@5: 92.0, R@10: 94.8, R@20: 96.4
2023-10-29 22:55:55   Improved: previous best R@5 = 92.0, current R@5 = 92.0
2023-10-29 22:55:55   Start training epoch: 08
2023-10-29 22:55:55   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.65it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:00:41   Epoch[08](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0242
2023-10-29 23:00:41   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.62it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.26it/s]
2023-10-29 23:05:27   Epoch[08](1/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0242
2023-10-29 23:05:27   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:12<00:00, 13.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.26it/s]
2023-10-29 23:10:12   Epoch[08](2/5): current batch triplet loss = 0.0845, average epoch triplet loss = 0.0235
2023-10-29 23:10:12   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.64it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:14:58   Epoch[08](3/5): current batch triplet loss = 0.0034, average epoch triplet loss = 0.0233
2023-10-29 23:14:58   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:19:45   Epoch[08](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0233
2023-10-29 23:19:45   Finished epoch 08 in 0:23:49, average epoch triplet loss = 0.0233
2023-10-29 23:19:45   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.63it/s]
2023-10-29 23:21:11   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:08<00:00,  3.49it/s]
2023-10-29 23:22:19   Calculating recalls
2023-10-29 23:22:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.4, R@5: 92.2, R@10: 94.9, R@20: 96.6
2023-10-29 23:22:32   Improved: previous best R@5 = 92.0, current R@5 = 92.2
2023-10-29 23:22:32   Start training epoch: 09
2023-10-29 23:22:32   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.62it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 23:27:19   Epoch[09](0/5): current batch triplet loss = 0.2248, average epoch triplet loss = 0.0225
2023-10-29 23:27:19   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:32:05   Epoch[09](1/5): current batch triplet loss = 0.0185, average epoch triplet loss = 0.0224
2023-10-29 23:32:05   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.56it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-29 23:36:52   Epoch[09](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0221
2023-10-29 23:36:52   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:41:38   Epoch[09](3/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0221
2023-10-29 23:41:38   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-29 23:46:25   Epoch[09](4/5): current batch triplet loss = 0.0014, average epoch triplet loss = 0.0222
2023-10-29 23:46:25   Finished epoch 09 in 0:23:52, average epoch triplet loss = 0.0222
2023-10-29 23:46:25   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:28<00:00,  3.55it/s]
2023-10-29 23:47:53   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:08<00:00,  3.48it/s]
2023-10-29 23:49:02   Calculating recalls
2023-10-29 23:49:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.2, R@5: 92.1, R@10: 94.7, R@20: 96.7
2023-10-29 23:49:16   Not improved: 1 / 3: best R@5 = 92.2, current R@5 = 92.1
2023-10-29 23:49:16   Start training epoch: 10
2023-10-29 23:49:16   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.74it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.49it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.19it/s]
2023-10-29 23:54:04   Epoch[10](0/5): current batch triplet loss = 0.0004, average epoch triplet loss = 0.0240
2023-10-29 23:54:04   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.74it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.52it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.21it/s]
2023-10-29 23:58:52   Epoch[10](1/5): current batch triplet loss = 0.1866, average epoch triplet loss = 0.0230
2023-10-29 23:58:52   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.74it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.47it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.18it/s]
2023-10-30 00:03:40   Epoch[10](2/5): current batch triplet loss = 0.0015, average epoch triplet loss = 0.0228
2023-10-30 00:03:40   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.74it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.48it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.20it/s]
2023-10-30 00:08:29   Epoch[10](3/5): current batch triplet loss = 0.0019, average epoch triplet loss = 0.0226
2023-10-30 00:08:29   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.74it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.47it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.20it/s]
2023-10-30 00:13:17   Epoch[10](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0224
2023-10-30 00:13:17   Finished epoch 10 in 0:24:00, average epoch triplet loss = 0.0224
2023-10-30 00:13:17   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.61it/s]
2023-10-30 00:14:44   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.51it/s]
2023-10-30 00:15:52   Calculating recalls
2023-10-30 00:16:06   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 92.1, R@10: 94.9, R@20: 96.6
2023-10-30 00:16:06   Not improved: 2 / 3: best R@5 = 92.2, current R@5 = 92.1
2023-10-30 00:16:06   Start training epoch: 11
2023-10-30 00:16:06   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.53it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.16it/s]
2023-10-30 00:20:55   Epoch[11](0/5): current batch triplet loss = 0.0069, average epoch triplet loss = 0.0223
2023-10-30 00:20:55   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.54it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.16it/s]
2023-10-30 00:25:44   Epoch[11](1/5): current batch triplet loss = 0.0106, average epoch triplet loss = 0.0221
2023-10-30 00:25:44   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.51it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-30 00:30:33   Epoch[11](2/5): current batch triplet loss = 0.0119, average epoch triplet loss = 0.0215
2023-10-30 00:30:33   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.50it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.18it/s]
2023-10-30 00:35:22   Epoch[11](3/5): current batch triplet loss = 0.0623, average epoch triplet loss = 0.0211
2023-10-30 00:35:22   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.53it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-30 00:40:10   Epoch[11](4/5): current batch triplet loss = 0.0100, average epoch triplet loss = 0.0210
2023-10-30 00:40:10   Finished epoch 11 in 0:24:04, average epoch triplet loss = 0.0210
2023-10-30 00:40:10   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:28<00:00,  3.55it/s]
2023-10-30 00:41:39   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:09<00:00,  3.44it/s]
2023-10-30 00:42:48   Calculating recalls
2023-10-30 00:43:02   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 92.3, R@10: 94.9, R@20: 96.7
2023-10-30 00:43:02   Improved: previous best R@5 = 92.2, current R@5 = 92.3
2023-10-30 00:43:02   Start training epoch: 12
2023-10-30 00:43:02   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.57it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.18it/s]
2023-10-30 00:47:50   Epoch[12](0/5): current batch triplet loss = 0.0268, average epoch triplet loss = 0.0189
2023-10-30 00:47:50   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.51it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-30 00:52:39   Epoch[12](1/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0198
2023-10-30 00:52:39   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.57it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-30 00:57:27   Epoch[12](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0200
2023-10-30 00:57:27   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.17it/s]
2023-10-30 01:02:16   Epoch[12](3/5): current batch triplet loss = 0.0772, average epoch triplet loss = 0.0202
2023-10-30 01:02:16   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.54it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.18it/s]
2023-10-30 01:07:04   Epoch[12](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0201
2023-10-30 01:07:04   Finished epoch 12 in 0:24:02, average epoch triplet loss = 0.0201
2023-10-30 01:07:04   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.63it/s]
2023-10-30 01:08:30   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:09<00:00,  3.43it/s]
2023-10-30 01:09:40   Calculating recalls
2023-10-30 01:09:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 92.2, R@10: 94.9, R@20: 96.7
2023-10-30 01:09:52   Not improved: 1 / 3: best R@5 = 92.3, current R@5 = 92.2
2023-10-30 01:09:52   Start training epoch: 13
2023-10-30 01:09:52   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:02<00:00,  8.19it/s]
2023-10-30 01:14:40   Epoch[13](0/5): current batch triplet loss = 0.0146, average epoch triplet loss = 0.0207
2023-10-30 01:14:40   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:32<00:00,  3.73it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.57it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.25it/s]
2023-10-30 01:19:28   Epoch[13](1/5): current batch triplet loss = 0.0014, average epoch triplet loss = 0.0202
2023-10-30 01:19:28   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:24:14   Epoch[13](2/5): current batch triplet loss = 0.0142, average epoch triplet loss = 0.0198
2023-10-30 01:24:14   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.56it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:29:01   Epoch[13](3/5): current batch triplet loss = 0.0100, average epoch triplet loss = 0.0197
2023-10-30 01:29:01   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.61it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:33:47   Epoch[13](4/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0195
2023-10-30 01:33:47   Finished epoch 13 in 0:23:54, average epoch triplet loss = 0.0195
2023-10-30 01:33:47   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:26<00:00,  3.63it/s]
2023-10-30 01:35:14   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.53it/s]
2023-10-30 01:36:21   Calculating recalls
2023-10-30 01:36:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.9, R@5: 92.3, R@10: 94.9, R@20: 96.8
2023-10-30 01:36:33   Not improved: 2 / 3: best R@5 = 92.3, current R@5 = 92.3
2023-10-30 01:36:33   Start training epoch: 14
2023-10-30 01:36:33   Cache: 0 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.23it/s]
2023-10-30 01:41:20   Epoch[14](0/5): current batch triplet loss = 0.0236, average epoch triplet loss = 0.0184
2023-10-30 01:41:20   Cache: 1 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.75it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:14<00:00, 13.50it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:46:07   Epoch[14](1/5): current batch triplet loss = 0.1249, average epoch triplet loss = 0.0185
2023-10-30 01:46:07   Cache: 2 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.58it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:50:53   Epoch[14](2/5): current batch triplet loss = 0.0283, average epoch triplet loss = 0.0187
2023-10-30 01:50:53   Cache: 3 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.56it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 01:55:40   Epoch[14](3/5): current batch triplet loss = 0.0229, average epoch triplet loss = 0.0189
2023-10-30 01:55:40   Cache: 4 / 5
100%|█████████████████████████████████████████████████████████████| 344/344 [01:31<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [01:13<00:00, 13.59it/s]
100%|███████████████████████████████████████████████████████████| 1000/1000 [02:01<00:00,  8.24it/s]
2023-10-30 02:00:26   Epoch[14](4/5): current batch triplet loss = 0.0177, average epoch triplet loss = 0.0188
2023-10-30 02:00:26   Finished epoch 14 in 0:23:53, average epoch triplet loss = 0.0188
2023-10-30 02:00:26   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:25<00:00,  3.65it/s]
2023-10-30 02:01:52   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 238/238 [01:07<00:00,  3.50it/s]
2023-10-30 02:03:00   Calculating recalls
2023-10-30 02:03:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.6, R@5: 92.2, R@10: 94.8, R@20: 96.8
2023-10-30 02:03:12   Not improved: 3 / 3: best R@5 = 92.3, current R@5 = 92.2
2023-10-30 02:03:12   Performance did not improve for 3 epochs. Stop training.
2023-10-30 02:03:12   Best R@5: 92.3
2023-10-30 02:03:12   Trained for 15 epochs, in total in 6:40:48
2023-10-30 02:03:12   Extracting database features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 313/313 [01:25<00:00,  3.66it/s]
2023-10-30 02:04:37   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:59<00:00,  3.56it/s]
2023-10-30 02:05:38   Calculating recalls
2023-10-30 02:05:50   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 79.4, R@5: 90.3, R@10: 93.5, R@20: 95.5
==========Testing=============
/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/best_model.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-0.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-1.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-10.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-11.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-12.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-13.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-14.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-2.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-3.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-4.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-5.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-6.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-7.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-8.pth /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-9.pth
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/best_model.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 02:05:52   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/best_model.pth', saturation=0, save_dir='test/default/2023-10-30_02-05-52', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 02:05:52   The outputs are being saved in test/default/2023-10-30_02-05-52
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 02:05:53   Train last layers of the vgg16, freeze the previous ones
2023-10-30 02:05:54   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/best_model.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 02:09:23   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 02:09:23   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.72it/s]
2023-10-30 02:10:52   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.71it/s]
2023-10-30 02:11:50   Calculating recalls
2023-10-30 02:12:00   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.0, R@5: 92.2, R@10: 94.5, R@20: 96.1
2023-10-30 02:12:00   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 02:12:00   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:39<00:00,  3.72it/s]
2023-10-30 02:22:45   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.08it/s]
2023-10-30 02:22:48   Calculating recalls
2023-10-30 02:22:52   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 61.6, R@5: 72.4, R@10: 75.6, R@20: 80.3
2023-10-30 02:22:52   Finished in 0:16:59
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-0.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 02:22:54   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-0.pth', saturation=0, save_dir='test/default/2023-10-30_02-22-54', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 02:22:54   The outputs are being saved in test/default/2023-10-30_02-22-54
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 02:22:55   Train last layers of the vgg16, freeze the previous ones
2023-10-30 02:22:56   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-0.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 02:26:31   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 02:26:31   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.70it/s]
2023-10-30 02:28:01   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.68it/s]
2023-10-30 02:28:59   Calculating recalls
2023-10-30 02:29:10   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 78.8, R@5: 90.2, R@10: 93.0, R@20: 95.0
2023-10-30 02:29:10   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 02:29:10   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:41<00:00,  3.70it/s]
2023-10-30 02:39:57   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.07it/s]
2023-10-30 02:40:01   Calculating recalls
2023-10-30 02:40:04   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 51.4, R@5: 65.7, R@10: 70.8, R@20: 74.9
2023-10-30 02:40:04   Finished in 0:17:10
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-1.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 02:40:06   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-1.pth', saturation=0, save_dir='test/default/2023-10-30_02-40-06', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 02:40:06   The outputs are being saved in test/default/2023-10-30_02-40-06
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 02:40:07   Train last layers of the vgg16, freeze the previous ones
2023-10-30 02:40:08   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-1.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 02:43:46   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 02:43:46   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.69it/s]
2023-10-30 02:45:15   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:58<00:00,  3.67it/s]
2023-10-30 02:46:13   Calculating recalls
2023-10-30 02:46:24   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 80.3, R@5: 90.7, R@10: 93.5, R@20: 95.5
2023-10-30 02:46:24   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 02:46:24   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:37<00:00,  3.72it/s]
2023-10-30 02:57:06   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.09it/s]
2023-10-30 02:57:10   Calculating recalls
2023-10-30 02:57:14   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 52.7, R@5: 67.0, R@10: 72.7, R@20: 78.4
2023-10-30 02:57:14   Finished in 0:17:07
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-10.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 02:57:16   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-10.pth', saturation=0, save_dir='test/default/2023-10-30_02-57-16', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 02:57:16   The outputs are being saved in test/default/2023-10-30_02-57-16
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 02:57:16   Train last layers of the vgg16, freeze the previous ones
2023-10-30 02:57:17   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-10.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 03:00:53   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 03:00:53   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.71it/s]
2023-10-30 03:02:22   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.69it/s]
2023-10-30 03:03:20   Calculating recalls
2023-10-30 03:03:30   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.4, R@5: 92.2, R@10: 94.6, R@20: 96.1
2023-10-30 03:03:31   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 03:03:31   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:38<00:00,  3.72it/s]
2023-10-30 03:14:14   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.08it/s]
2023-10-30 03:14:18   Calculating recalls
2023-10-30 03:14:22   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 62.5, R@5: 72.4, R@10: 78.1, R@20: 81.6
2023-10-30 03:14:22   Finished in 0:17:06
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-11.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 03:14:24   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-11.pth', saturation=0, save_dir='test/default/2023-10-30_03-14-24', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 03:14:24   The outputs are being saved in test/default/2023-10-30_03-14-24
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 03:14:24   Train last layers of the vgg16, freeze the previous ones
2023-10-30 03:14:25   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-11.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 03:18:00   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 03:18:00   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.70it/s]
2023-10-30 03:19:30   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.69it/s]
2023-10-30 03:20:28   Calculating recalls
2023-10-30 03:20:38   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.0, R@5: 92.2, R@10: 94.5, R@20: 96.1
2023-10-30 03:20:39   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 03:20:39   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:39<00:00,  3.71it/s]
2023-10-30 03:31:24   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.11it/s]
2023-10-30 03:31:27   Calculating recalls
2023-10-30 03:31:31   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 61.6, R@5: 72.4, R@10: 75.6, R@20: 80.3
2023-10-30 03:31:31   Finished in 0:17:07
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-12.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 03:31:33   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-12.pth', saturation=0, save_dir='test/default/2023-10-30_03-31-33', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 03:31:33   The outputs are being saved in test/default/2023-10-30_03-31-33
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 03:31:34   Train last layers of the vgg16, freeze the previous ones
2023-10-30 03:31:34   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-12.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 03:35:12   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 03:35:12   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.70it/s]
2023-10-30 03:36:42   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.69it/s]
2023-10-30 03:37:39   Calculating recalls
2023-10-30 03:37:50   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 82.9, R@5: 92.2, R@10: 94.3, R@20: 95.9
2023-10-30 03:37:50   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 03:37:50   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:38<00:00,  3.72it/s]
2023-10-30 03:48:34   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.10it/s]
2023-10-30 03:48:38   Calculating recalls
2023-10-30 03:48:42   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 60.3, R@5: 72.4, R@10: 76.8, R@20: 80.0
2023-10-30 03:48:42   Finished in 0:17:08
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-13.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 03:48:44   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-13.pth', saturation=0, save_dir='test/default/2023-10-30_03-48-44', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 03:48:44   The outputs are being saved in test/default/2023-10-30_03-48-44
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 03:48:44   Train last layers of the vgg16, freeze the previous ones
2023-10-30 03:48:45   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-13.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 03:52:20   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 03:52:20   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:23<00:00,  3.73it/s]
2023-10-30 03:53:49   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.71it/s]
2023-10-30 03:54:47   Calculating recalls
2023-10-30 03:54:57   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.1, R@5: 92.2, R@10: 94.4, R@20: 95.9
2023-10-30 03:54:58   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 03:54:58   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 04:05:38   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.10it/s]
2023-10-30 04:05:42   Calculating recalls
2023-10-30 04:05:45   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 61.3, R@5: 72.1, R@10: 76.2, R@20: 80.6
2023-10-30 04:05:45   Finished in 0:17:01
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-14.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 04:05:47   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-14.pth', saturation=0, save_dir='test/default/2023-10-30_04-05-47', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 04:05:47   The outputs are being saved in test/default/2023-10-30_04-05-47
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 04:05:48   Train last layers of the vgg16, freeze the previous ones
2023-10-30 04:05:49   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-14.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 04:09:23   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 04:09:23   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.72it/s]
2023-10-30 04:10:52   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.71it/s]
2023-10-30 04:11:50   Calculating recalls
2023-10-30 04:12:00   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.0, R@5: 92.2, R@10: 94.3, R@20: 96.0
2023-10-30 04:12:00   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 04:12:00   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 04:22:41   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.03it/s]
2023-10-30 04:22:45   Calculating recalls
2023-10-30 04:22:48   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 62.9, R@5: 73.7, R@10: 76.5, R@20: 80.3
2023-10-30 04:22:48   Finished in 0:17:01
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-2.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 04:22:50   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-2.pth', saturation=0, save_dir='test/default/2023-10-30_04-22-50', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 04:22:50   The outputs are being saved in test/default/2023-10-30_04-22-50
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 04:22:51   Train last layers of the vgg16, freeze the previous ones
2023-10-30 04:22:52   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-2.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 04:26:28   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 04:26:28   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.70it/s]
2023-10-30 04:27:57   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.69it/s]
2023-10-30 04:28:55   Calculating recalls
2023-10-30 04:29:05   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.4, R@5: 91.3, R@10: 93.8, R@20: 95.6
2023-10-30 04:29:05   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 04:29:05   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:40<00:00,  3.71it/s]
2023-10-30 04:39:51   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.07it/s]
2023-10-30 04:39:54   Calculating recalls
2023-10-30 04:39:58   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 55.9, R@5: 69.5, R@10: 75.9, R@20: 80.6
2023-10-30 04:39:58   Finished in 0:17:07
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-3.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 04:40:00   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-3.pth', saturation=0, save_dir='test/default/2023-10-30_04-40-00', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 04:40:00   The outputs are being saved in test/default/2023-10-30_04-40-00
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 04:40:01   Train last layers of the vgg16, freeze the previous ones
2023-10-30 04:40:02   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-3.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 04:43:39   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 04:43:39   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.70it/s]
2023-10-30 04:45:08   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.68it/s]
2023-10-30 04:46:05   Calculating recalls
2023-10-30 04:46:16   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.9, R@5: 91.4, R@10: 94.0, R@20: 95.9
2023-10-30 04:46:16   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 04:46:16   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:39<00:00,  3.71it/s]
2023-10-30 04:57:01   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.08it/s]
2023-10-30 04:57:05   Calculating recalls
2023-10-30 04:57:09   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 58.4, R@5: 70.8, R@10: 74.9, R@20: 79.4
2023-10-30 04:57:09   Finished in 0:17:08
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-4.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 04:57:10   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-4.pth', saturation=0, save_dir='test/default/2023-10-30_04-57-10', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 04:57:10   The outputs are being saved in test/default/2023-10-30_04-57-10
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 04:57:11   Train last layers of the vgg16, freeze the previous ones
2023-10-30 04:57:12   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-4.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 05:00:49   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 05:00:49   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.71it/s]
2023-10-30 05:02:19   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.69it/s]
2023-10-30 05:03:16   Calculating recalls
2023-10-30 05:03:27   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 82.3, R@5: 91.9, R@10: 94.3, R@20: 96.0
2023-10-30 05:03:27   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 05:03:27   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:40<00:00,  3.71it/s]
2023-10-30 05:14:14   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.09it/s]
2023-10-30 05:14:17   Calculating recalls
2023-10-30 05:14:21   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 57.8, R@5: 71.1, R@10: 76.2, R@20: 79.0
2023-10-30 05:14:21   Finished in 0:17:10
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-5.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 05:14:23   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-5.pth', saturation=0, save_dir='test/default/2023-10-30_05-14-23', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 05:14:23   The outputs are being saved in test/default/2023-10-30_05-14-23
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 05:14:24   Train last layers of the vgg16, freeze the previous ones
2023-10-30 05:14:24   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-5.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 05:18:02   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 05:18:02   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.73it/s]
2023-10-30 05:19:30   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.71it/s]
2023-10-30 05:20:27   Calculating recalls
2023-10-30 05:20:38   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 82.8, R@5: 92.1, R@10: 94.5, R@20: 96.1
2023-10-30 05:20:38   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 05:20:38   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 05:31:17   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.12it/s]
2023-10-30 05:31:21   Calculating recalls
2023-10-30 05:31:25   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 60.0, R@5: 73.7, R@10: 76.8, R@20: 80.6
2023-10-30 05:31:25   Finished in 0:17:01
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-6.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 05:31:27   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-6.pth', saturation=0, save_dir='test/default/2023-10-30_05-31-27', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 05:31:27   The outputs are being saved in test/default/2023-10-30_05-31-27
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 05:31:27   Train last layers of the vgg16, freeze the previous ones
2023-10-30 05:31:28   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-6.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 05:35:03   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 05:35:03   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.73it/s]
2023-10-30 05:36:31   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.72it/s]
2023-10-30 05:37:29   Calculating recalls
2023-10-30 05:37:39   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 82.9, R@5: 92.3, R@10: 94.7, R@20: 96.0
2023-10-30 05:37:39   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 05:37:39   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 05:48:19   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.07it/s]
2023-10-30 05:48:23   Calculating recalls
2023-10-30 05:48:26   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 59.7, R@5: 72.7, R@10: 76.8, R@20: 80.3
2023-10-30 05:48:26   Finished in 0:16:59
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-7.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 05:48:28   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-7.pth', saturation=0, save_dir='test/default/2023-10-30_05-48-28', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 05:48:28   The outputs are being saved in test/default/2023-10-30_05-48-28
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 05:48:29   Train last layers of the vgg16, freeze the previous ones
2023-10-30 05:48:30   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-7.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 05:52:04   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 05:52:04   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.72it/s]
2023-10-30 05:53:33   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.72it/s]
2023-10-30 05:54:30   Calculating recalls
2023-10-30 05:54:41   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.0, R@5: 92.3, R@10: 94.6, R@20: 95.9
2023-10-30 05:54:41   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 05:54:41   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 06:05:21   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.15it/s]
2023-10-30 06:05:25   Calculating recalls
2023-10-30 06:05:29   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 61.0, R@5: 72.4, R@10: 76.8, R@20: 81.0
2023-10-30 06:05:29   Finished in 0:17:00
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-8.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 06:05:30   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-8.pth', saturation=0, save_dir='test/default/2023-10-30_06-05-30', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 06:05:30   The outputs are being saved in test/default/2023-10-30_06-05-30
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 06:05:31   Train last layers of the vgg16, freeze the previous ones
2023-10-30 06:05:32   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-8.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 06:09:11   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 06:09:11   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:23<00:00,  3.73it/s]
2023-10-30 06:10:39   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.72it/s]
2023-10-30 06:11:36   Calculating recalls
2023-10-30 06:11:47   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 83.3, R@5: 92.3, R@10: 94.5, R@20: 96.2
2023-10-30 06:11:47   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 06:11:47   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 06:22:27   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
2023-10-30 06:22:31   Calculating recalls
2023-10-30 06:22:35   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 60.6, R@5: 74.6, R@10: 77.5, R@20: 80.3
2023-10-30 06:22:35   Finished in 0:17:04
============Done================
Processing /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-9.pth ...
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/scipy/__init__.py:143: UserWarning: A NumPy version >=1.19.5 and <1.27.0 is required for this version of SciPy (detected version 1.19.4)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
2023-10-30 06:22:36   Arguments: Namespace(aggregation='netvlad', backbone='vgg16', brightness=0, cache_refresh_rate=1000, contrast=0, criterion='triplet', dataset_name='pitts30k', datasets_folder='datasets_vg/datasets', device='cuda', efficient_ram_testing=False, epochs_num=1000, fc_output_dim=None, freeze_te=None, horizontal_flip=False, hue=0, infer_batch_size=32, l2='before_pool', lr=1e-05, lr_crn_layer=0.005, lr_crn_net=0.0005, majority_weight=0.01, margin=0.1, mining='full', neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, off_the_shelf='imagenet', optim='sgd', patience=3, pca_dataset_folder='pitts30k/images/train', pca_dim=4096, pretrain='imagenet', queries_per_epoch=5000, rand_perspective=0, random_resized_crop=0, random_rotation=0, recall_values=[1, 5, 10, 20], resize=[480, 640], resume='/home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-9.pth', saturation=0, save_dir='test/default/2023-10-30_06-22-36', seed=43, test_method='hard_resize', train_batch_size=4, train_positives_dist_threshold=10, trunc_te=None, val_positive_dist_threshold=25)
2023-10-30 06:22:36   The outputs are being saved in test/default/2023-10-30_06-22-36
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/leo/anaconda3/envs/vpr-benchmark/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-10-30 06:22:37   Train last layers of the vgg16, freeze the previous ones
2023-10-30 06:22:38   Resuming model from /home/leo/usman_ws/models/graphvlad/benchmarking_vg/pitts30k-vgg16-triplet-lr0.0001-29-Oct/triplet-9.pth
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
2023-10-30 06:26:12   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2023-10-30 06:26:12   Extracting database features for evaluation/testing
load PCA parameters...
100%|█████████████████████████████████████████████████████████████| 313/313 [01:24<00:00,  3.73it/s]
2023-10-30 06:27:42   Extracting queries features for evaluation/testing
100%|█████████████████████████████████████████████████████████████| 213/213 [00:57<00:00,  3.71it/s]
2023-10-30 06:28:39   Calculating recalls
2023-10-30 06:28:50   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 82.9, R@5: 92.3, R@10: 94.3, R@20: 96.0
2023-10-30 06:28:50   Test set: < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >
2023-10-30 06:28:50   Extracting database features for evaluation/testing
load PCA parameters...
100%|███████████████████████████████████████████████████████████| 2375/2375 [10:35<00:00,  3.74it/s]
2023-10-30 06:39:31   Extracting queries features for evaluation/testing
100%|███████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.12it/s]
2023-10-30 06:39:35   Calculating recalls
2023-10-30 06:39:39   Recalls on < BaseDataset, tokyo247 - #database: 75984; #queries: 315 >: R@1: 60.6, R@5: 72.4, R@10: 75.6, R@20: 81.3
2023-10-30 06:39:39   Finished in 0:17:02
============Done================
